<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <title>必应每日一图相册 by XuanboWang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" href="https://bingphotoaction.pages.dev/favicon.png" type="image/x-icon">
  <meta name="description" content="Bing 必应每日一图图册 - 每日精选来自必应的高质量壁纸库，永久保存必应搜索精选图片，支持1080p和4K分辨率高清原图下载，提供支持高级参数的 API，支持查看历史必应每日一图，海量高清图片收藏库。">
  <meta name="keywords" content="必应图册,必应每日一图,每日一图下载,每日壁纸,图片库,高清壁纸,4K下载,免费素材,图片收藏,历史图片,历史壁纸,图片记录">
  <meta name="author" content="XuanboWang">
  <meta property="og:title" content="必应每日一图图册">
  <meta property="og:description" content="海量高质量必应精选图片，永久免费图册库，完整历史图片记录，提供支持高级参数的 API,1080p和4K分辨率原图下载">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="必应每日一图图册">
  <meta name="twitter:description" content="精选高清图片图册库，查看完整历史记录，提供支持高级参数的 API,每日更新，免费下载高清壁纸">
  <style>
    .page-header h1 {
      font-weight: 300;
    }
    .subtitle {
      font-size: 0.875rem;
      color: #6c757d;
      margin-bottom: 2rem;
    }
    .copyright-text {
      font-size: 0.875rem;
      color: #6c757d;
      font-style: italic;
    }
    footer {
      background-color: #f8f9fa;
      border-top: 1px solid #dee2e6;
      margin-top: 3rem;
      padding: 2rem 0;
      font-size: 0.875rem;
      color: #6c757d;
    }
    footer a {
      color: #0d6efd;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
    .page-info {
      text-align: center;
      font-size: 0.875rem;
      color: #6c757d;
      margin: 2rem 0;
    }
    .card {
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .card-img-top {
      object-fit: cover;
      height: 200px;
    }
    .card-title {
      font-size: 1rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #212529;
    }
    .card-text {
      font-size: 0.875rem;
      color: #6c757d;
      margin-bottom: 1rem;
      line-height: 1.4;
    }
    .card-footer {
      background-color: #f8f9fa;
      border-top: 1px solid #dee2e6;
      padding: 0.75rem 1rem;
      font-size: 0.875rem;
    }
    .photo-page {
      display: flex;
      flex-wrap: wrap;
      width: 100%;
      gap: 1rem;
    }
    .photo-page .col {
      flex: 0 0 calc(25% - 0.75rem);
    }
    @media (max-width: 1199.98px) {
      .photo-page .col {
        flex: 0 0 calc(33.333333% - 0.67rem);
      }
    }
    @media (max-width: 991.98px) {
      .photo-page .col {
        flex: 0 0 calc(50% - 0.5rem);
      }
    }
    @media (max-width: 767.98px) {
      .photo-page .col {
        flex: 0 0 100%;
      }
    }
    /* 分页响应式样式 */
    .pagination-container {
    /*  overflow-x: auto;*/
      -webkit-overflow-scrolling: touch;
      padding-bottom: 5px;
    }
    .pagination {
      flex-wrap: nowrap;
      margin-bottom: 0;
    }
    .pagination .page-link {
      min-width: 40px;
      text-align: center;
      padding: 0.375rem 0.5rem;
      font-size: 0.875rem;
    }
    @media (max-width: 767.98px) {
      .pagination {
        flex-wrap: wrap;
        justify-content: center;
      }
      .pagination .page-item {
        margin-bottom: 2px;
      }
      .pagination .page-link {
        padding: 0.25rem 0.375rem;
        font-size: 0.8125rem;
        min-width: 36px;
      }
    }
    /* 跳转页面组件 */
    .page-jump-container {
      max-width: 300px;
      margin: 1.5rem auto;
    }
    @media (max-width: 767.98px) {
      .page-jump-container {
        max-width: 250px;
      }
    }
    /* 新增样式：标题区域布局 */
    .title-area {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      flex-wrap: wrap;
      margin-bottom: 0rem;
    }
    .subtitle-container {
      flex: 1;
      min-width: 0;
    }
    .api-link-container {
      margin-left: 1rem;
      display: flex;
      align-items: center;
    }
    /* 移动端适配 */
    @media (max-width: 767.98px) {
      .title-area {
        align-items: flex-start;
      }
      .api-link-container {
        margin-left: 0;
        margin-top: 0.5rem;
        align-self: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="page-header mb-4">
      <h1>必应每日一图相册</h1>
    </div>
    <!-- 修改这里：将 subtitle 和 API 链接放在同一个容器中 -->
    <div class="title-area">
      <div class="subtitle-container">
        <div class="subtitle" id="summary">正在加载照片信息…</div>
      </div>
      <div class="api-link-container">
        <a href="https://bphoto.xuanbo.top/api/" class="btn btn-outline-primary btn-sm" target="_blank" rel="noopener">
          API
        </a>
      </div>
    </div>
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
      <div id="gallery" class="photo-page"></div>
    </div>

    <!-- 分页导航 -->
    <nav class="mt-5" aria-label="Page navigation">
      <div class="pagination-container">
        <ul class="pagination justify-content-center" id="pagination"></ul>
      </div>
    </nav>

    <!-- 跳转到页面组件 -->
    <div class="page-jump-container">
      <div class="input-group input-group-sm">
        <span class="input-group-text">转至</span>
        <input type="number" id="jumpPageInput" class="form-control" placeholder="页码" min="1" max="90">
        <button class="btn btn-primary" type="button" id="jumpPageBtn">跳转</button>
      </div>
    </div>

    <div class="text-center mt-3 text-muted">
      第 <span id="current-page">1</span> / <span id="total-pages">1</span> 页 <br>每页最多显示 <span id="per-page">12</span> 张
    </div>
  </div>

<footer>
  <div class="container text-center">
    <p>Copyright © <a href="https://github.com/XuanboWangCN" target="_blank">XuanboWang</a> 2025. All rights reserved.<br>
    Powered by <a href="https://xuanbo.top" target="_blank">Xuanbo.top</a><br>在 Github 中查看源代码：<a href="https://github.com/XuanboWangCN/bingphotoaction/" target="_blank">github.com/XuanboWangCN/bingphotoaction</a></p>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://xuanbo.top/assets/howmanyarevisitors.js" defer></script>
<script>
    (function(){
        const PER_PAGE = 12;
        const TOTAL_PHOTOS = 1077;
        const TOTAL_PAGES = 90;
        const PAGE_JSON_DIR = 'htmlphotosinfojson';
        let photos = [];
        let observer = null;

        function $(sel){ return document.querySelector(sel); }
        function $$(sel){ return document.querySelectorAll(sel); }
        function getQueryPage(){const p = parseInt(new URLSearchParams(location.search).get('page')) || 1; return Math.max(1,p);}
        function updateURL(page){const url=new URL(location.href);url.searchParams.set('page',page);history.replaceState(null,'',url);}
        function formatDate(d){if(!d) return ''; const s=String(d); if(/^\d{8}$/.test(s)) return `${s.slice(0,4)}/${s.slice(4,6)}/${s.slice(6,8)}`; if(/^\d{12}$/.test(s)) return `${s.slice(0,4)}/${s.slice(4,6)}/${s.slice(6,8)}`; return s;}

        function createCard(item){
            const col=document.createElement('div'); col.className='col';
            const card=document.createElement('div'); card.className='card h-100';
            const img=document.createElement('img'); img.className='card-img-top lazy'; img.alt=item.title||''; img.setAttribute('data-src', item.url||''); img.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22200%22%3E%3Crect width=%22100%25%22 height=%22100%25%22 fill=%22%23eee%22/%3E%3C/svg%3E'; img.loading='lazy';
            const body=document.createElement('div'); body.className='card-body d-flex flex-column';
            const bodyInner=document.createElement('div'); bodyInner.className='flex-grow-1';
            const title=document.createElement('h5'); title.className='card-title'; title.textContent=item.title||'';
            const desc=document.createElement('p'); desc.className='card-text'; desc.textContent=item.copyright||'';
            bodyInner.appendChild(title); bodyInner.appendChild(desc);
            const btnGroup=document.createElement('div'); btnGroup.className='btn-group w-100 mt-2'; btnGroup.role='group';
            const dlGroup=document.createElement('div'); dlGroup.className='btn-group flex-grow-1'; dlGroup.role='group';
            const dlBtn=document.createElement('button'); dlBtn.type='button'; dlBtn.className='btn btn-sm btn-secondary dropdown-toggle'; dlBtn.setAttribute('data-bs-toggle','dropdown'); dlBtn.textContent='下载图片';
            const dlMenu=document.createElement('ul'); dlMenu.className='dropdown-menu';
            const li1080=document.createElement('li'); li1080.innerHTML=`<a class="dropdown-item" href="${item.url}" download>1080p</a>`;
            const li4k=document.createElement('li'); li4k.innerHTML=`<a class="dropdown-item" href="${(item.urlBase||'')}_UHD.jpg" download>UHD (4K)</a>`;
            dlMenu.appendChild(li1080); dlMenu.appendChild(li4k); dlGroup.appendChild(dlBtn); dlGroup.appendChild(dlMenu);
            const viewBtn=document.createElement('a'); viewBtn.className='btn btn-sm btn-primary'; viewBtn.target='_blank'; viewBtn.textContent='在必应中查看'; viewBtn.href=item.copyrightLink||'#';
            btnGroup.appendChild(dlGroup); btnGroup.appendChild(viewBtn);
            body.appendChild(bodyInner); body.appendChild(btnGroup);
            const footer=document.createElement('div'); footer.className='card-footer text-muted'; footer.textContent = formatDate(item.startDate || (item.raw && item.raw.startdate) || item.fullstartdate || '');
            card.appendChild(img); card.appendChild(body); card.appendChild(footer); col.appendChild(card); return col;
        }

        function clearGallery(){const g=$('#gallery'); if(g) g.innerHTML='';}

        function renderFromArray(arr, page){
            clearGallery(); const frag=document.createDocumentFragment(); arr.forEach(it=>frag.appendChild(createCard(it))); $('#gallery').appendChild(frag);
            document.getElementById('current-page').textContent = page; 
            document.getElementById('total-pages').textContent = TOTAL_PAGES; 
            document.getElementById('per-page').textContent = PER_PAGE; 
            updatePagination(page, TOTAL_PAGES); 
            updateURL(page);
            updateJumpPageInput(page);
            if(observer) observer.disconnect(); 
            observer = new IntersectionObserver((entries)=>{ 
                entries.forEach(en=>{ 
                    if(en.isIntersecting){ 
                        const img=en.target; 
                        const src=img.getAttribute('data-src'); 
                        if(src){ 
                            img.src=src; 
                            img.removeAttribute('data-src'); 
                        } 
                        observer.unobserve(img); 
                    } 
                }); 
            }, {rootMargin: '200px'});
            $$('img.lazy').forEach(img=>observer.observe(img));
        }

        function updateJumpPageInput(page) {
            const input = $('#jumpPageInput');
            if (input) {
                input.value = page;
                input.max = TOTAL_PAGES;
            }
        }

        function updatePagination(current, total){
            const container=document.getElementById('pagination'); container.innerHTML=''; const maxButtons=9;
            function makeItem(label,page,disabled,active){ 
                const li=document.createElement('li'); 
                li.className='page-item'+(disabled?' disabled':'')+(active?' active':''); 
                const a=document.createElement('a'); 
                a.className='page-link'; 
                a.href='?page='+page; 
                a.textContent=label; 
                a.addEventListener('click', function(e){ 
                    e.preventDefault(); 
                    if(!disabled) loadPage(page); 
                }); 
                li.appendChild(a); 
                return li; 
            }
            container.appendChild(makeItem('上一页', Math.max(1,current-1), current<=1, false));
            if(total <= maxButtons){ 
                for(let i=1;i<=total;i++) 
                    container.appendChild(makeItem(i,i,false,i===current)); 
            } else { 
                const windowSize = maxButtons - 2; 
                let start = Math.max(2, current - Math.floor(windowSize/2)); 
                let end = start + windowSize -1; 
                if(end >= total){ 
                    end = total-1; 
                    start = end - windowSize +1; 
                } 
                container.appendChild(makeItem(1,1,false,current===1)); 
                if(start>2) container.appendChild(makeItem('...', start-1, true, false)); 
                for(let i=start;i<=end;i++) 
                    container.appendChild(makeItem(i,i,false,i===current)); 
                if(end < total-1) container.appendChild(makeItem('...', end+1, true, false)); 
                container.appendChild(makeItem(total,total,false,current===total)); 
            }
            container.appendChild(makeItem('下一页', Math.min(total, current+1), current>=total, false));
        }

        function loadPage(page){
            page = Math.max(1, Math.min(parseInt(page), TOTAL_PAGES));
            const pageJson = `${PAGE_JSON_DIR}/page-${page}.json`;
            fetch(pageJson, {cache:'no-cache'}).then(r=>{ 
                if(r.ok) return r.json(); 
                throw new Error('no page json'); 
            }).then(arr=>{ 
                renderFromArray(arr, page); 
            }).catch(()=>{ // 回退到整体 photos.json
                fetch('photos.json', {cache:'no-cache'}).then(r=>r.json()).then(all=>{ 
                    const total = Math.ceil(all.length / PER_PAGE) || 1; 
                    const p = Math.max(1, Math.min(page, total)); 
                    const start=(p-1)*PER_PAGE; 
                    renderFromArray(all.slice(start, start+PER_PAGE), p); 
                }).catch(err=>{ 
                    document.getElementById('summary').textContent='加载照片数据失败'; 
                    console.error(err); 
                });
            });
        }

        function initJumpPage() {
            const jumpBtn = $('#jumpPageBtn');
            const jumpInput = $('#jumpPageInput');
            
            if (jumpBtn && jumpInput) {
                // 按钮点击事件
                jumpBtn.addEventListener('click', function() {
                    const page = parseInt(jumpInput.value);
                    if (page >= 1 && page <= TOTAL_PAGES) {
                        loadPage(page);
                    } else {
                        alert('请输入有效的页码 (1-' + TOTAL_PAGES + ')');
                        jumpInput.focus();
                    }
                });
                
                // 输入框回车事件
                jumpInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        jumpBtn.click();
                    }
                });
            }
        }

        window.addEventListener('load', function(){
            // 控制台美化输出
            console.log('%c必应每日一图相册 - Github项目地址：https://github.com/XuanboWangCN/bingphotoaction  \n知识共享署名协议 4.0 国际版本（CC-BY 4.0）\n© 2025 XuanboWang（ https://github.com/XuanboWangCN ）. All rights reserved.', 'background: #222; color: #bada55; font-size: 12px; padding: 5px; border-radius: 3px;');
            
            document.getElementById('summary').textContent = `已保存来自必应的 ${TOTAL_PHOTOS} 张图片`;
            loadPage(getQueryPage());
            initJumpPage();
        });
    })();
</script></body></html>